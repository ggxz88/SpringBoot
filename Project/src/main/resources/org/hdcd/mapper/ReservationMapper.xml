<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.hdcd.mapper.ReservationMapper">

	<insert id="create">
		INSERT INTO movie_reservation
			(
			reserve_info,
			user_id,
			title,
			province_name,
			city,
			show_date,
			show_time,
			screen_name,
			seat_id,
			price
			)
		VALUES
			(
			#{reserveInfo},
			#{userId},
			#{title},
			#{provinceName},
			#{city},
			#{showDate},
			#{showTime},
			#{screenName},
			#{seatId},
			#{price}
			)
	</insert>
	
	<select id="read" resultType="Reservation">
		SELECT movie_reserve_no, 
			reserve_info,
			user_id,
			title,
			province_name,
			city,
			show_date,
			show_time,
			screen_name,
			seat_id,
			price
		  FROM movie_reservation
		 WHERE movie_reserve_no = #{movieReserveNo}
	</select>

	<select id="listAll" resultType="Reservation">
		<![CDATA[
			SELECT movie_reserve_no, 
				reserve_info,
				user_id,
				title,
				province_name,
				city,
				show_date,
				show_time,
				screen_name,
				seat_id,
				price
			  FROM movie_reservation
			 WHERE movie_reserve_no > 0
			ORDER BY movie_reserve_no DESC, reg_date DESC
		]]>
	</select>
	
	<select id="list" resultType="Reservation">
		<![CDATA[
			SELECT movie_reserve_no, 
				reserve_info,
				user_id,
				title,
				province_name,
				city,
				show_date,
				show_time,
				screen_name,
				seat_id,
				price
			  FROM movie_reservation
			 WHERE user_id = #{userId}
			ORDER BY movie_reserve_no DESC, reg_date DESC
		]]>
	</select>
	
	<select id="getSeatList" resultType="Seat">
		SELECT seat_no, 
			seat_id,
			price
		  FROM movie_seat
		 WHERE screen_name = (SELECT screen_name
				  FROM movie_time
				 WHERE show_time = #{showTime})
	</select>
	
</mapper>